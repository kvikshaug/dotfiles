#!/usr/bin/fish
# This file controls the contents of my dwm status bar
# It is set by the proc in .xinitrc every minute via 'xsetroot -name'

# The mail line is retrieved in this file
cat .dwmsb-mail-current | tr -d '\n'

# if discharging, show remaining power
if test (cat /proc/acpi/battery/BAT0/state | grep charging | awk '{print $3}') != 'charged'
  echo -n (cat /proc/acpi/battery/BAT0/state | grep remaining | awk '{print $3}')
  echo -n " | "
end

# cpu temp
sensors | grep temp1 | awk '{print $2}' | sed 's/+//' | sed 's/..Â°C//' | tr -d '\n'
echo -n " | "

# mem usg, thanks to: http://github.com/halhen/dotfiles/blob/master/.statusline.sh
free -b | awk 'NR == 2 { print int(0.5 + 1000 * ($3 - ($6 + $7)) / $2)/10}' | tr -d '\n'
echo -n "% | "

# load avg
cat /proc/loadavg | cut -d ' ' -f 1,2,3 | tr -d '\n'
echo -n " | "

# disk usage
df -h | grep sda4 | awk '{ print $3 "/" $4 "/" $5 }' | sed 's/G//g' | tr -d '\n'
echo -n " | "

# show date
echo -n (date +"%F %R")
